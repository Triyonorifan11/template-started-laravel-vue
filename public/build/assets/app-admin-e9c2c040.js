import{a as g,_ as m,o as u,c as h,r as _,b as R,d as E,e as P,f as A,m as i,F as I,N as L,g as S,M as p,h as $}from"./global-plugin-0862b267.js";const w=()=>{const t=localStorage.getItem("token");return g.create({baseURL:baseUrl,headers:{Authorization:t?"Bearer "+t:""}})},y={};function b(t,s){return u(),h("h1",null,"Login")}const k=m(y,[["render",b]]),D={data(){return{baseUrl,ROLE_ADMIN:"admin",SUPER_ADMIN:"super-admin",CONSUMER:"customer",DEVELOPER:"developer",ROLE_REVIEWER:"reviewer"}},mounted(){if(console.log(this.$store.state.profile),console.log("super-admin"),this.ROLE_ADMIN==this.$store.state.profile.roleId)this.$router.push({path:"/booking"});else if(this.SUPER_ADMIN==this.$store.state.profile.roleId)this.$router.push({path:"/booking"});else if(this.ROLE_REVIEWER==this.$store.state.profile.roleId)this.$router.push({path:"/booking"});else if(this.CONSUMER==this.$store.state.profile.roleId){const s=new URLSearchParams(window.location.search).get("code");s?this.$router.push({path:"/reguler/booking",query:{code:s}}):this.$router.push({path:"/reguler/booking"})}}},M={class:"p-8 d-flex justify-content-center align-items-center",style:{"min-height":"100vh",width:"100%"}};function U(t,s,r,a,o,l){const n=_("app-loader");return u(),h("div",null,[R("div",M,[E(n)])])}const O=m(D,[["render",U]]),N=[{path:"/login",name:"login",component:k,meta:{guest:!0,title:"Login"}},{path:"/",component:O,name:"Home",meta:{title:"Home",auth:!0}},{path:"/403",component:I,meta:{title:"403 - Menara Danareksa",auth:!0}},{path:"/:pathMatch(.*)*",redirect:"/404",title:"403 - Menara Danareksa"},{path:"/404",component:L,meta:{title:"404 - Menara Danareksa",auth:!0}}],d=P({history:A(SUBFOLDER_DOMAIN),routes:N,scrollBehavior(t,s,r){return{top:0}}});d.beforeEach(async(t,s,r)=>{try{if(t.matched.some(a=>a.meta.title)&&t.meta&&t.meta.title&&(document.title=t.meta.title),t.matched.some(a=>a.meta.auth))if(localStorage.getItem("token")){if(i.state.profile.isLoggedIn)return t.matched.some(a=>a.meta.specificRole)&&t.meta&&t.meta.specificRole&&t.meta.specificRole.length>0&&t.meta.specificRole.filter(o=>o==i.state.profile.roleId).length==0?r("/403"):r();try{const a=await w().get("api/auth/me");if(i.commit("profile/SET_PROFILE_DATA",a.data.data),t.matched.some(n=>n.meta.specificRole)&&t.meta&&t.meta.specificRole&&t.meta.specificRole.length>0&&t.meta.specificRole.filter(f=>f==a.data.data.role.slug).length==0)return r("/403");const l=new URLSearchParams(window.location.search).get("code");return l?r({name:"Home",query:{code:l}}):r()}catch(a){return localStorage.clear(),i.commit("profile/SET_PROFILE_DATA",null),console.error(a),r("/login")}}else{const o=new URLSearchParams(window.location.search).get("code");return r(o?{name:"login",query:{code:o}}:"/login")}else if(t.matched.some(a=>a.meta.guest))if(localStorage.getItem("token")){const o=new URLSearchParams(window.location.search).get("code");return r(o?{name:"Home",query:{code:o}}:"/")}else return r();else return r()}catch{return console.error("Error during route navigation:",e),localStorage.clear(),i.commit("profile/SET_PROFILE_DATA",null),r("/login")}});const c=S({MainApp:p});c.component("main-app",p);c.use(d);c.use($);c.mount("#main-app");
